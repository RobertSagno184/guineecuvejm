<div class="client-dashboard">
  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading()">
    <div class="spinner"></div>
    <p>Chargement de votre tableau de bord...</p>
  </div>

  <!-- Dashboard Content -->
  <div class="dashboard-content" *ngIf="!isLoading()">
    <!-- Welcome Section -->
    <div class="welcome-section">
      <div class="welcome-content">
        <div class="greeting">
          <h1>Bonjour, {{ getCustomerName() }} ! üëã</h1>
          <p class="welcome-subtitle">
            <span *ngIf="stats().totalOrders > 0">
              Vous avez {{ stats().totalOrders }} commande(s) au total
            </span>
            <span *ngIf="stats().totalOrders === 0">
              Bienvenue ! Commencez √† explorer notre catalogue
            </span>
          </p>
        </div>
        <div class="quick-actions" *ngIf="stats().totalOrders > 0">
          <a routerLink="/client/commandes" class="quick-action-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            Mes commandes
          </a>
          <a routerLink="/client/catalogue" class="quick-action-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="M21 21l-4.35-4.35"></path>
            </svg>
            Catalogue
          </a>
        </div>
      </div>
      <div class="welcome-illustration">
        <div class="illustration-circle"></div>
        <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
      </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-grid">
      <div class="stat-card stat-primary">
        <div class="stat-header">
          <div class="stat-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
          </div>
          <div class="stat-trend" *ngIf="stats().totalOrders > 0">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
              <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
          </div>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ stats().totalOrders }}</div>
          <div class="stat-label">Total commandes</div>
          <div class="stat-description">Toutes vos commandes</div>
        </div>
      </div>

      <div class="stat-card stat-success">
        <div class="stat-header">
          <div class="stat-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="1" x2="12" y2="23"></line>
              <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
          </div>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ stats().totalSpent | price }}</div>
          <div class="stat-label">Total d√©pens√©</div>
          <div class="stat-description">Montant total de vos achats</div>
        </div>
      </div>

      <div class="stat-card stat-warning">
        <div class="stat-header">
          <div class="stat-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
          </div>
          <div class="stat-badge" *ngIf="stats().pendingOrders > 0">
            {{ stats().pendingOrders }}
          </div>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ stats().pendingOrders }}</div>
          <div class="stat-label">En attente</div>
          <div class="stat-description">Commandes en cours de traitement</div>
        </div>
      </div>

      <div class="stat-card stat-info">
        <div class="stat-header">
          <div class="stat-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
          </div>
        </div>
        <div class="stat-content">
          <div class="stat-value">{{ stats().processingOrders }}</div>
          <div class="stat-label">En pr√©paration</div>
          <div class="stat-description">Commandes en cours d'exp√©dition</div>
        </div>
      </div>
    </div>

    <!-- Main Content Grid -->
    <div class="main-content-grid">
      <!-- Recent Orders -->
      <div class="dashboard-section orders-section">
        <div class="section-header">
          <div class="section-title">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <h2>Derni√®res commandes</h2>
          </div>
          <a routerLink="/client/commandes" class="view-all-link">
            Voir tout
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </a>
        </div>
        <div class="orders-list" *ngIf="recentOrders().length > 0; else noOrders">
          <div 
            class="order-item" 
            *ngFor="let order of recentOrders(); let i = index"
            [routerLink]="['/client/commandes', order.id]"
            [style.animation-delay]="i * 0.1 + 's'"
          >
            <div class="order-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
              </svg>
            </div>
            <div class="order-info">
              <div class="order-number">{{ order.orderNumber }}</div>
              <div class="order-meta">
                <span class="order-date">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                  {{ order.createdAt | date:'shortDate':'fr-FR' }}
                </span>
                <span class="order-items">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                  </svg>
                  {{ order.items.length }} article(s)
                </span>
              </div>
            </div>
            <div class="order-details">
              <div class="order-amount">{{ order.total | price }}</div>
              <div class="order-status-badge" [style.background-color]="getStatusColor(order.status) + '20'" [style.color]="getStatusColor(order.status)">
                {{ getStatusLabel(order.status) }}
              </div>
            </div>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="arrow-icon">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </div>
        </div>
        <ng-template #noOrders>
          <div class="empty-state">
            <div class="empty-icon">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
              </svg>
            </div>
            <h3>Aucune commande pour le moment</h3>
            <p>Commencez √† explorer notre catalogue et passez votre premi√®re commande</p>
            <a routerLink="/client/catalogue" class="btn-primary">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="M21 21l-4.35-4.35"></path>
              </svg>
              Parcourir le catalogue
            </a>
          </div>
        </ng-template>
      </div>

      <!-- Stock Alerts -->
      <div class="dashboard-section alerts-section" *ngIf="favoriteProductsLowStock().length > 0">
        <div class="section-header">
          <div class="section-title">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <h2>Alertes de stock</h2>
          </div>
          <span class="alert-count-badge">{{ favoriteProductsLowStock().length }}</span>
        </div>
        <div class="alerts-list">
          <div 
            class="alert-item" 
            *ngFor="let product of favoriteProductsLowStock(); let i = index"
            [routerLink]="['/client/catalogue', product.id]"
            [style.animation-delay]="i * 0.1 + 's'"
          >
            <div class="alert-icon" [class.out-of-stock]="product.stock === 0">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
            </div>
            <div class="alert-content">
              <div class="alert-product-name">{{ product.name }}</div>
              <div class="alert-stock-info" [class.out-of-stock]="product.stock === 0">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
                {{ product.stock === 0 ? 'Rupture de stock' : `Stock faible: ${product.stock} unit√©s` }}
              </div>
            </div>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="arrow-icon">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </div>
        </div>
      </div>

      <!-- Empty Alerts State -->
      <div class="dashboard-section alerts-section-empty" *ngIf="favoriteProductsLowStock().length === 0">
        <div class="empty-alerts-state">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
          <h3>Aucune alerte</h3>
          <p>Tous vos produits favoris sont en stock</p>
        </div>
      </div>
    </div>

    <!-- Recommended Products -->
    <div class="dashboard-section recommended-section">
      <div class="section-header">
        <div class="section-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
          <h2>Produits recommand√©s pour vous</h2>
        </div>
        <a routerLink="/client/catalogue" class="view-all-link">
          Voir tout le catalogue
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </a>
      </div>
      <div class="products-grid" *ngIf="recommendedProducts().length > 0; else noProducts">
        <app-product-card
          *ngFor="let product of recommendedProducts()"
          [product]="product"
          [showAddToCart]="true"
          [showFavorite]="true"
          [showQuote]="true"
          (addToCart)="onAddToCart($event)"
          (addToFavorites)="onAddToFavorites($event)"
          (requestQuote)="onRequestQuote($event)"
        ></app-product-card>
      </div>
      <ng-template #noProducts>
        <div class="empty-state">
          <div class="empty-icon">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
          </div>
          <h3>Aucun produit recommand√©</h3>
          <p>Nous n'avons pas encore de recommandations pour vous</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
